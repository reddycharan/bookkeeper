<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="${sys:bookkeeper.log.level}" monitorInterval="15">
  <Properties>
    <!-- the value of ADDITIONALAPPENDER has to be CONSOLE, BOOKIESHELL-FILEAPPENDER or empty-->
    <!-- by default we use CONSOLE appender, if the value of this sys env variable is BOOKIESHELL-FILEAPPENDER then it goes to both CONSOLE and BOOKIESHELL-FILEAPPENDER-->
    <Property name="ADDITIONALAPPENDER">${sys:bookieshell.logger.appender:-CONSOLE}</Property>
  </Properties>
  <Appenders>
    <Console name="CONSOLE" target="SYSTEM_OUT">
      <PatternLayout pattern="%d{ABSOLUTE} %-5p %m%n"/>
    </Console>
    <RollingFile name="BOOKIESHELL-FILEAPPENDER" fileName="${sys:bookkeeper.log.dir}/${sys:bookkeeper.log.file}"
    	filePattern="${sys:bookkeeper.log.dir}/${sys:bookkeeper.log.pattern}"
    	immediateFlush="false" filePermissions="rw-r-----">
      <PatternLayout pattern="%d{yyyyMMddHHmmss.SSSSSS} [%-5p] [%t] [%F:%L] - %m%n"/>
      <Policies>
      	<SizeBasedTriggeringPolicy size="10 MB"/>
      </Policies>
      <DefaultRolloverStrategy>
        <Delete basePath="${sys:bookkeeper.log.dir}" maxDepth="3">
          <!-- Delete log files older than P[days]D old -->
          <IfLastModified age="${sys:bookkeeper.log.max.fileAge}" />
          <IfAny>
            <!-- please check  //apps/sfstorage/bookkeeper/main/build/bookieshell file where BOOKIE_LOG_FORMAT is defined and it contains .bookieshell. in it-->
            <IfFileName regex=".*\.bookieshell\..*\.log.*" />
          </IfAny>
        </Delete>
      </DefaultRolloverStrategy>
    </RollingFile>
  </Appenders>
  <Loggers>
    <Logger name="org.apache.bookkeeper.bookie.BookieShell" level="info" additivity="false" includeLocation="true">
      <AppenderRef ref="CONSOLE"/>
      <!-- Its ok for the value of ADDITIONALAPPENDER to be CONSOLE. Though it is repeated it logs only once to the CONSOLE appender.-->
      <AppenderRef ref="${ADDITIONALAPPENDER}"/>      
    </Logger>
    <Logger name="org.apache.bookkeeper.client.BookKeeperAdmin" level="info" additivity="false" includeLocation="true">
      <AppenderRef ref="CONSOLE"/>
      <!-- Its ok for the value of ADDITIONALAPPENDER to be CONSOLE. Though it is repeated it logs only once to the CONSOLE appender.-->
      <AppenderRef ref="${ADDITIONALAPPENDER}"/>
    </Logger>
    <Root level="${sys:bookkeeper.log.level}" includeLocation="true">
      <AppenderRef ref="CONSOLE"/>
      <!-- Its ok for the value of ADDITIONALAPPENDER to be CONSOLE. Though it is repeated it logs only once to the CONSOLE appender.-->
      <AppenderRef ref="${ADDITIONALAPPENDER}"/>
    </Root>
  </Loggers>
</Configuration>